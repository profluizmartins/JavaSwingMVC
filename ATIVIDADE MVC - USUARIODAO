package app.model;

import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import app.exception.UsuarioException;

/**
 * Classe de manipulação de DAO da Usuário
 * @author José Henrique
 * @version 1.1
 */
public class UsuarioDAO {
	private List<Usuario> usuarios = new ArrayList<Usuario>();
	private int proximoId = 1;

	/**
	 * Método de adicionar um usuário banco de dados
	 * @param nome  Nome do usuário
	 * @param email email do usuário
	 * @throws UsuarioException verificar de nome do usuário está correto
	 * @throws UsuarioException verificar se email está correto
	 */
	public void adicionarUsuario(String nome, String email) throws UsuarioException {
		if (nome == null || nome.equals("") || nome.length() <= 5) {
			throw new UsuarioException("Nome inválido");
		}
		if (email == null || email.equals("") || email.length() <= 5) {
			throw new UsuarioException("Email inválido");
		}

		usuarios.add(new Usuario(proximoId++, nome, email));
	}

	
	public List<Usuario> listarUsuarios() {
		return usuarios;
	}

	/**
    * Atualiza as informações de nome e e-mail de um usuário existente.
    * @param id O identificador do usuário que será atualizado.
    * @param novoNome O novo nome a ser definido. 
    * @param novoEmail O novo e-mail a ser definido. 
    * @return true se o usuário foi encontrado e atualizado; false caso contrário.
    * @throws UsuarioException Se o novo nome for inválido ou o e-mail for inválido.
    */
	
	public boolean atualizarUsuario(int id, String novoNome, String novoEmail) throws UsuarioException{
		
		if(novoNome.isBlank() || novoNome == null){
		    throw new UsuarioException("Nome não pode ser vazio");
		    
		}
		
		if(email == null || !email.contains("@")){
		    throw new UsuarioException("Email inválido!");
		    
		}
		
		for(Usuario u : usuarios){
		    if(u.getId() == id){
		        
		        u.setNome(novoNome);
		        u.setEmail(novoEmail);
		        return true;
		    }
		}
		
		return false;
	}

    /**
    * Remove um usuário da lista com base no seu id
    * @param id O id do usuário a ser removido.
    * @return true se algum usuário foi removido; false caso não haja usuário com o id informado.
    */

	public boolean removerUsuario(int id) {
		return usuarios.removeIf(u -> u.getId() == id);
	}

    /**
    * Busca e retorna um usuário pelo id informado
    * @param id O id do usuário a ser buscado.
    * @return O usuário correspondente ao id ou null se não encontrado.
    */

    
	public Usuario buscarPorId(int id) {
		for (Usuario u : usuarios) {
			if (u.getId() == id)
				return u;
		}
		return null;
	}
}
